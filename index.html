<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Portfolio Alerts - Sign Up</title>
  <style>
    body { font-family: system-ui, sans-serif; max-width: 500px; margin: 50px auto; padding: 20px; }
    input, select, button { display: block; width: 100%; margin: 10px 0; padding: 12px; font-size: 16px; }
    button { background: #007bff; color: white; border: none; cursor: pointer; border-radius: 4px; }
    button:hover { background: #0056b3; }
    .tier-select { margin: 20px 0; }
    label { font-weight: 500; margin-top: 15px; display: block; }
    #message { margin-top: 20px; padding: 12px; border-radius: 4px; }
    .success { background: #d4edda; color: #155724; }
    .error { background: #f8d7da; color: #721c24; }
  </style>
</head>
<body>
  <h2>üìà Portfolio Alert Signup</h2>
  <p>Get notified when your stocks move significantly.</p>
  
  <form id="signupForm">
    <label>Email</label>
    <input type="email" name="email" required placeholder="you@example.com">
    
    <label>Portfolio Name</label>
    <input type="text" name="portfolio_name" placeholder="My Growth Portfolio">
    
    <label>Tickers (comma-separated)</label>
    <input type="text" name="tickers" required placeholder="AAPL, MSFT, TSLA, NVDA">
    
    <div class="tier-select">
      <label>Select Tier</label>
      <select name="tier" id="tierSelect">
        <option value="free">Free - Up to 5 Tickers</option>
        <option value="pro">Pro - Up to 20 Tickers ($9/mo)</option>
      </select>
    </div>
    
    <button type="submit">Create Account</button>
  </form>

  <div id="message"></div>

  <script>
    // REPLACE THIS WITH YOUR ACTUAL N8N WEBHOOK URL
    const WEBHOOK_URL = 'https://YOUR_N8N_INSTANCE/webhook/signup';
    
    document.getElementById('signupForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(e.target);
      const data = Object.fromEntries(formData);
      
      // Parse tickers into array and validate
      data.tickers = data.tickers.split(',').map(t => t.trim().toUpperCase()).filter(t => t);
      
      // Enforce free tier limit client-side
      const tierLimits = { free: 5, pro: 20 };
      const maxTickers = tierLimits[data.tier] || 5;
      
      if (data.tickers.length > maxTickers) {
        showMessage(`Free tier limited to ${maxTickers} tickers. You selected ${data.tickers.length}.`, 'error');
        return;
      }
      
      try {
        const response = await fetch(WEBHOOK_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        
        if (!response.ok) throw new Error('Signup failed');
        
        showMessage('‚úÖ Success! Check your email to confirm.', 'success');
        e.target.reset();
      } catch (err) {
        showMessage('‚ùå Error: ' + err.message, 'error');
      }
    });
    
    function showMessage(text, type) {
      const msg = document.getElementById('message');
      msg.textContent = text;
      msg.className = type;
    }
  </script>
</body>
</html>
